---
title: Música | É possível aplicar Ciência de Dados?
author: Luis Otavio
date: '2020-04-27'
slug: musica-e-possivel-aplicar-ciencia-de-dados
categories:
  - Caso prático
tags:
  - Música
  - Text Mining
type: post
image: images/post_principal/freddie.jpg
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/wordcloud2/wordcloud.css" rel="stylesheet" />
<script src="/rmarkdown-libs/wordcloud2/wordcloud2-all.js"></script>
<script src="/rmarkdown-libs/wordcloud2/hover.js"></script>
<script src="/rmarkdown-libs/wordcloud2-binding/wordcloud2.js"></script>


<p>É um desafio encontrar uma área que não possa ser melhorada pela Ciência de Dados.</p>
<p>Um fator que ajuda muito nisso é o aumento exponencial da capacidade de medir e gerar dados, seja qual for a área.</p>
<p>Confesso a vocês que, até parar pra fazer esse artigo, nunca tinha imaginado haver tantos dados sobre músicas, álbuns e bandas.</p>
<p>No caso desse post, isso só foi viável pela excelente API que o <strong>Spotify</strong> possui. Ela fornece uma quantidade muito interessante de informações sobre cada música, album ou artista.</p>
<p>O que também facilitou muito o trabalho foi a biblioteca <strong>spotifyR</strong>. Uma verdadeira mão na roda para acessar os dados da API do Spotify pelo R.</p>
<p>Quanto mais subjetiva for a matéria de estudo, maior será a dificuldade de aplicar modelos estatísticos, por exemplo.</p>
<p>A música está dentro de um ramo artístico, portanto, um pouco longe das ciências exatas.</p>
<p>E, ainda assim, é possível aplicar Ciência de Dados! E com muito sucesso.</p>
<p>O Spotify possui sistemas de recomendação muito apurados em seu aplicativo. Então, com base no que você escuta, ele consegue te recomendar músicas e artistas que sejam alinhados com o seu gosto.</p>
<p>Imagino que uma parte desse modelo de recomendação seja composto pelos atributos que eles tem para cada música.</p>
<p>Que atributos são esses?</p>
<p>Para cada música o Spotify atribui valores entre 0 e 100 para vários atributos. Vou listar alguns:</p>
<ul>
<li>Acústica</li>
<li>Dançabilidade</li>
<li>Sonoridade</li>
<li>Energia</li>
<li>Discurso</li>
<li>Instrumentalidade</li>
<li>Ao vivo</li>
<li>Positividade</li>
</ul>
<p>Ainda que se tenha algumas aplicações práticas muito interessantes da Ciência de Dados na música, não obtive sucesso em todas as minhas tentativas.</p>
<p>Foi muito interessante perceber em gráficos quais as músicas mais tristes ou alegres de uma banda ou ver o modelo do Spotify rodando e nos ajudando a descobrir artistas que combinam muito com nosso gosto musical.</p>
<p>Porém, na minha extremamente breve tentativa de tentar achar um modelo para prever quais seriam as músicas de sucesso de uma banda, os resultados não foram tão satisfatórios.</p>
<div id="a-minha-análise-usando-os-dados-do-spotify" class="section level3">
<h3>A minha análise usando os dados do Spotify</h3>
<p>Fiz uma enquete lá no Instagram perguntando para o pessoal quais bandas gostariam que eu fizesse uma análise mais detalhada.</p>
<p>As vencedoras foram: Queen, U2, Pink Floyd e Red Hot Chili Peppers.</p>
<p>Peguei os valores da <strong>positividade</strong> e <strong>energia</strong> das músicas de cada uma dessas 4 bandas e montei o gráfico abaixo.
Inclui apenas as músicas do álbum principal de cada uma das bandas.</p>
<p>Apesar das bandas não terem estilos musicais muito distantes, é possível notar padrões nos quadrantes criados.</p>
<p>Dividi o gráfico com as classificações: Tristeza, Agitação/raiva, Alegria/Excitação e Tranquilidade.</p>
<p><img src="/images/post_interno/todos.png" style="width:75.0%" /></p>
<p>Cada ponto do gráfico é uma canção do álbum. Os álbuns escolhidos foram:</p>
<ul>
<li>U2, The Joshua Tree</li>
<li>Queen, Live At Wembley Stadium</li>
<li>Pink Floyd, The Later Years</li>
<li>Red Hot Chili Peppers, Californication</li>
</ul>
</div>
<div id="código-e-mais-análises" class="section level3">
<h3>Código e mais análises</h3>
<p>Agora vou compartilhar outras análises que fiz e o código utilizado.</p>
<div id="passo-1---instalarchamar-bibliotecas-e-autenticação" class="section level4">
<h4>Passo 1 - Instalar/Chamar bibliotecas e autenticação</h4>
<pre class="r"><code>library(tidyverse)
library(spotifyr)
library(genius)
library(tidytext)
library(gridExtra)
library(wordcloud2)
library(dplyr)
library(ggplot2)
library(highcharter)
library(RColorBrewer)
library(randomForest)</code></pre>
<pre class="r"><code># Você precisa criar as suas credenciais no Spotify e colocá-las aqui:
Sys.setenv(SPOTIFY_CLIENT_ID = &#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;)
Sys.setenv(SPOTIFY_CLIENT_SECRET = &#39;XXXXXXXXXXXXXXXXXXXXXXXXXX&#39;)
# Para criar o seu acesso a API de desenvolvedor do Spotify, siga os passos em:
# https://developer.spotify.com/dashboard/login</code></pre>
<p>Buscar o token de autenticação</p>
<pre class="r"><code>access_token &lt;- get_spotify_access_token()</code></pre>
</div>
<div id="buscar-e-limpar-os-dados" class="section level4">
<h4>Buscar e limpar os dados</h4>
<p>Essa função busca no Spotify as principais informações de todas as músicas da banda que você escolher.</p>
<p>No caso, escolhi o U2.</p>
<pre class="r"><code>banda &lt;- get_artist_audio_features(&#39;u2&#39;) ### Buscar os dados</code></pre>
<pre class="r"><code># Forças as algumas variáveis a serem da Classe de Fatores
banda$mode_name &lt;- as.factor(banda$mode_name)
banda$key_name &lt;- as.factor(banda$key_name)
banda$key_mode &lt;- as.factor(banda$key_mode)
banda$album_name &lt;- as.factor(banda$album_name)
banda$album_name &lt;- as.factor(banda$album_name)

# tirar musicas repetidas
banda&lt;-banda[!duplicated(banda$track_name),]

# tirar albuns repetidos
banda&lt;-dedupe_album_names(banda, album_name_col = &quot;album_name&quot;,
                   album_release_year_col = &quot;album_release_year&quot;)</code></pre>
</div>
<div id="principais-músicas-e-álbuns" class="section level4">
<h4>Principais músicas e álbuns</h4>
<p>Agora, busquei no Spotify quais são as músicas de mais sucesso da banda. Eles retornam as 10 músicas mais ouvidas.</p>
<pre class="r"><code># buscar músicas de maior sucesso no mercado Americano
top_tracks&lt;-get_artist_top_tracks(id=banda$artist_id[1], market = &quot;US&quot;,
                                  authorization = get_spotify_access_token(),
                                  include_meta_info = TRUE)$tracks

# criar uma coluna na tabela informando se a música é top track ou não.
banda &lt;- banda %&gt;%
  mutate(topsongs = ifelse(tolower(substr(banda$track_name, start = 1, stop = 11)) %in%
                             tolower(substr(top_tracks$name, start = 1, stop = 11)), 1,0))
banda$topsongs &lt;- as.factor(banda$topsongs)</code></pre>
<p>Definindo quais são os principais albuns da banda.</p>
<pre class="r"><code># Defini que os os principais albuns são aqueles que tem alguma música de sucesso
main_albuns&lt;-banda %&gt;% filter(topsongs==1) %&gt;%
  select(album_name)
banda_albums &lt;- banda[banda$album_name %in% main_albuns$album_name,]
banda &lt;- banda %&gt;%
  mutate(topalbum = ifelse(album_name %in% main_albuns$album_name , 1,0))
banda$topalbum &lt;- as.factor(banda$topalbum)</code></pre>
</div>
</div>
<div id="visualização-de-dados" class="section level3">
<h3>Visualização de dados</h3>
<p>Vamos começar a nossa visualização de dados analisando o sentimento das letras cantadas.</p>
<p>Busquei as 20 palavras mais cantadas no album e separamos as palavras em positivas e negativas.</p>
<p>Mas você concorda que palavras negativas podem ter intensidades muito diferentes?</p>
<p>Por exemplo, a palavra cortar é entendida como uma palavra negativa. Porém, sua intensidade é muito menor do que a de outras palavras negativas como veneno ou fogo.</p>
<p>Então, além de separar as palavras em positivas e negativas, vamos dar um score para cada sentimento.</p>
<pre class="r"><code>main_albuns$album_name&lt;-as.character(main_albuns$album_name)
indicador&lt;-names(which.max(table(main_albuns$album_name))[1])
banda_1 &lt;- banda %&gt;%
  filter(album_name == indicador)
banda_1 &lt;- banda_1[order(banda_1$tempo),] #sort
banda_1$track_name &lt;- factor(banda_1$track_name, levels = unique(banda_1$track_name))

#Creating a variable called D1 which contains all of the lyrics from Drake&#39;s album &quot;Thank Me Later&quot;
D1 &lt;- genius_album(artist = banda$artist_name[1], album = banda_1$album_name[1])

#Using the piping operator to create a count of the most popular words in the album 
D1 %&gt;% 
  unnest_tokens(word, lyric) %&gt;% 
  anti_join(stop_words) %&gt;% 
  count(word, sort = TRUE) -&gt; D1Count

#Using more piping operators to create afinn sentiment as well as create a subset of the data that includes the top 20 most popular words 
D1Count %&gt;% 
  inner_join(get_sentiments(&quot;afinn&quot;)) -&gt;  D1Sentiment

D1Sentiment %&gt;% head(20) -&gt; D1Sentiment2

#Creating a column called color that uses an if else statment to color the sentiment score by red if it is below 0 and green if it is above
D1Sentiment2$color &lt;- ifelse(D1Sentiment2$value &lt; 0, &quot;red&quot;, &quot;green&quot;)

#Creating a bar graph that shows each sentiment. The &quot;color=color&quot; in the ggplot() and scale_color_identity() are what allow the graph to color by red and green based off of the ifelse statement.
sentimento1 &lt;- ggplot(D1Sentiment2, aes(reorder(word, -n), value, color=color)) + geom_col(fill=&quot;white&quot;) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title=paste0(banda$artist_name[1],&quot; - &quot;,banda_1$album_name[1]), x=&quot;20 palavras mais cantadas&quot;, y=&quot;Score do sentimento&quot;) +
  theme(plot.title = element_text(size=15,hjust = 0.5)) +
  scale_color_identity()

sentimento1</code></pre>
<p><img src="/blog/musica-e-possivel-aplicar-ciencia-de-dados_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>As nuvens de palavras ou wordclouds são uma ótima ferramenta para visualizar quais palavras são mais frequentes.</p>
<pre class="r"><code>wordcloud2(data = D1Count)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"word":["love","rise","heart","day","night","hey","hold","walk","rain","gold","sky","run","wind","sweetest","america","blue","desert","yeah","deep","left","ohohoh","silver","angel","blessed","eyes","red","cold","door","feel","fire","hear","rainin","sea","hands","hill","set","soul","baby","break","bullet","country","found","god's","hang","tonight","town","wey","blown","hangin","light","lights","runs","song","streets","sun","waiting","white","alright","black","broken","burning","dry","ho","mao","naked","river","rose","shiny","stars","stone","till","wanna","bright","burned","city","crosses","earth","flame","free","ground","hand","healing","heartbeat","kings","lips","sister","sleep","sunlight","tin","walls","water","wave","world","arms","beating","callin","chained","crooked","darkest","daylight","devil","doorway","drug","fighter","floor","gonna","home","inside","live","losin","ooh","round","rust","sad","shines","sold","sons","sorrow","stand","storm","time","umm","wait","beaten","beneath","bird","bleed","blood","blowing","captains","chains","children","colours","comin","coming","cure","cut","desire","dream","dreams","dust","faith","fall","feeling","fever","field","finger","garden","golden","green","gun","head","heat","holy","honey","hot","hunter","leaves","nails","neck","ocean","reach","rising","save","scream","shoes","sick","spanish","tears","thunder","torn","tree","trees","year's","africa","ah","ahead","alight","ancient","begin","bent","bind","blind","body","bows","boy","bring","building","cain","calls","canvas","capital","ceiling","closed","clothes","cloud","collect","corner","crawling","crawls","cross","dark","daughters","deeper","die","distance","dreamed","dreamers","dress","eyed","fallen","father","fear","feet","forever","gift","heartbeats","heavy","hit","holdin","hole","hope","hotel","howling","hundred","hunted","hurts","jesus","letters","liberty","likes","lose","lost","mind","mister","moon","morning","navy","nettle","newspapers","nose","ohh","pain","painted","past","planes","power","praying","prisoners","prize","punch","quiet","race","raincloud","rescue","return","ribbons","rivers","roadside","rope","royal","sealed","shackles","shadows","shame","shelter","shore","shotgun","shut","silence","sing","sinister","siren","skies","slowly","son","souls","south","stands","starry","steel","sting","stop","street","talk","tear","temperature","thin","thirsty","thorn","told","trigger","trip","true","twist","uniforms","valley","vanity","voice","warden","wash","wet","window","wires","wore","written","ya","17","1956","act","alleys","angelic","angels","apartheid","argue","argument","arise","artist","artists","astray","atom","avalanche","awake","awhile","baby's","ball","bard","barrel","bass","bed","begs","begun","billboards","bills","bishop","blankets","bleeding","blossoms","blues","bomb","bonds","bones","born","bother","bottle","breathes","breeze","bride","brightly","broke","brown","bruised","bug","buggin","build","bullets","burn","burnin","burroughs","bush","buy","calling","captain","car","cardboard","carnival","carried","carved","catch","caverns","cedar","cents","chain","cherry","child","children's","chill","chorus","chosen","cities","city's","climbed","clothed","coal","coat","coloured","control","corn","cracked","crash","crawl","crawled","creep","cries","crossed","crowd","crown","cruel","cruelty","cry","cryin","danger","darkness","dazzled","deaf","demands","demon","dew","dewy","dirt","disappear","discover","disease","dog","dollar","dollars","doorstep","doubt","drive","drivin","drum","drums","ears","economic","edge","eggs","ego","em","emotion","emperor","empty","enduring","entwined","eternal","evening","everyday","exit","exit's","facing","fail","falling","fate","fell","fields","firefly","fist","flames","flood","flower","flush","follow","form","friend","frozen","fuck","future","gapin","gathered","girl","glass","glow","god","gotta","grass","grave","groan","hair","hangs","hard","haze","heard","hearted","hearts","heh","held","hell's","helps","heyyy","hide","hills","holds","hour","house","howlin","hum","human","huts","india","inherit","injured","insane","invented","jacob","january","jara","johannesburg","joke","jokes","jumping","key","king","kingdom","kiss","kissed","kneel","knees","labour","land","lands","lapsed","laughter","leave","legs","libraries","life","lifted","lines","link","listen","locust","lone","loneliness","lonely","loosed","love's","low","lyric","machinery","makes","mass","meek","meet","meets","memories","menelik","merciful","mercy","midnight","million","mine","months","morn","mountain","mountains","mud","murder","music","necklace","nobility","north","obsession","oooh","oppressor","orange","overcome","overcomes","path","pay","peacemakers","peelin","pelting","penny","perfect","petal","pistol","plain","plant","play","plum","pocket","poem","poets","poison","pole","poor","pound","practical","precious","prisoner","pull","pulls","pushing","putting","queen","rainfall","raise","rape","rattle","read","ready","real","recall","recalls","record","refuse","remain","renew","request","ripped","rises","roses","rubber","runnin","running","saint","sanctions","sand","sang","saxophone","scaled","scared","scars","scent","scorch","scratch","scrolls","seam","seed","send","seraphim","settle","sew","sex","shadow","shakin","shanty","shape","sheba's","shepherd","shine","ship's","ships","shit","shithouse","sight","sink","skin","slappin","sleight","slipstream","slumberous","slums","speak","speaks","speedway","spirit","split","spoke","staircase","stairway","standing","start","started","stay","steven","stingin","stooped","stormy","strand","straw","stretched","stripped","stumble","stupid","sugar","suit","suitcase","summerhill","sunshine","supermarket","support","sweet","swim","tangiers","telling","thee","thirty","thou","throat","thrones","throws","tie","tied","tight","tiny","tips","tongue","touch","trace","trampled","trial","trotskyites","truth","tutu","twenty","unbuttoned","understand","underway","undone","unlock","verse","views","wafer","wake","walked","walking","war","warm","watery","waves","weapon","wear","weeping","weighed","west","wheel","wide","wilt","win","window's","wisdom","women","word","worker's","worn","worthy","wound","wounded","wrestled","write","yeahhhh","yeahhhhhh","yeahhhhhhh","yep","york","zone",null],"freq":[73,50,24,22,21,20,19,19,18,17,17,16,16,15,14,14,13,13,12,12,12,12,11,11,11,11,10,10,10,10,10,10,10,9,9,9,9,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":2.46575342465753,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
<p>Por fim, coloquei em um gráfico os valores de <strong>energia</strong> e <strong>positividade</strong> de cada música do principal album da banda.</p>
<pre class="r"><code>artist_quadrant_chart(banda_1) %&gt;% 
  hc_add_event_point(event = &#39;mouseOver&#39;)</code></pre>
<p><img src="/images/post_interno/joshuatree.png" style="width:75.0%" /></p>
</div>
