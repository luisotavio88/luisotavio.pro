---
title: Música | É possível aplicar Ciência de Dados?
author: Luis Otavio
date: '2020-04-27'
slug: musica-e-possivel-aplicar-ciencia-de-dados
categories:
  - Caso prático
tags:
  - Música
  - Text Mining
type: post
image: images/post_principal/freddie.jpg
---

<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/wordcloud2/wordcloud.css" rel="stylesheet" />
<script src="/rmarkdown-libs/wordcloud2/wordcloud2-all.js"></script>
<script src="/rmarkdown-libs/wordcloud2/hover.js"></script>
<script src="/rmarkdown-libs/wordcloud2-binding/wordcloud2.js"></script>


<p>É um desafio encontrar uma área que não possa ser melhorada pela Ciência de Dados.</p>
<p>Um fator que ajuda muito nisso é o aumento exponencial da capacidade de medir e gerar dados, seja qual for a área.</p>
<p>Confesso a vocês que, até parar pra fazer esse artigo, nunca tinha imaginado haver tantos dados sobre músicas, álbuns e bandas.</p>
<p>No caso desse post, isso só foi viável pela excelente API que o <strong>Spotify</strong> possui. Ela fornece uma quantidade muito interessante de informações sobre cada música, album ou artista.</p>
<p>O que também facilitou muito o trabalho foi a biblioteca <strong>spotifyR</strong>. Uma verdadeira mão na roda para acessar os dados da API do Spotify pelo R.</p>
<p>Quanto mais subjetiva for a matéria de estudo, maior será a dificuldade de aplicar modelos estatísticos, por exemplo.</p>
<p>A música está dentro de um ramo artístico, portanto, um pouco longe das ciências exatas.</p>
<p>E, ainda assim, é possível aplicar Ciência de Dados! E com muito sucesso.</p>
<p>O Spotify possui sistemas de recomendação muito apurados em seu aplicativo. Então, com base no que você escuta, ele consegue te recomendar músicas e artistas que sejam alinhados com o seu gosto.</p>
<p>Imagino que uma parte desse modelo de recomendação seja composto pelos atributos que eles tem para cada música.</p>
<p>Que atributos são esses?</p>
<p>Para cada música o Spotify atribui valores entre 0 e 100 para vários atributos. Vou listar alguns:</p>
<ul>
<li>Acústica</li>
<li>Dançabilidade</li>
<li>Sonoridade</li>
<li>Energia</li>
<li>Discurso</li>
<li>Instrumentalidade</li>
<li>Ao vivo</li>
<li>Positividade</li>
</ul>
<p>Ainda que se tenha algumas aplicações práticas muito interessantes da Ciência de Dados na música, não obtive sucesso em todas as minhas tentativas.</p>
<p>Foi muito interessante perceber em gráficos quais as músicas mais tristes ou alegres de uma banda ou ver o modelo do Spotify rodando e nos ajudando a descobrir artistas que combinam muito com nosso gosto musical.</p>
<p>Porém, na minha extremamente breve tentativa de tentar achar um modelo para prever quais seriam as músicas de sucesso de uma banda, os resultados não foram tão satisfatórios.</p>
<div id="a-minha-análise-usando-os-dados-do-spotify" class="section level3">
<h3>A minha análise usando os dados do Spotify</h3>
<p>Fiz uma enquete lá no Instagram perguntando para o pessoal quais bandas gostariam que eu fizesse uma análise mais detalhada.</p>
<p>As vencedoras foram: Queen, U2, Pink Floyd e Red Hot Chili Peppers.</p>
<p>Peguei os valores da <strong>positividade</strong> e <strong>energia</strong> das músicas de cada uma dessas 4 bandas e montei o gráfico abaixo.
Inclui apenas as músicas do álbum principal de cada uma das bandas.</p>
<p>Apesar das bandas não terem estilos musicais muito distantes, é possível notar padrões nos quadrantes criados.</p>
<p>Dividi o gráfico com as classificações: Tristeza, Agitação/raiva, Alegria/Excitação e Tranquilidade.</p>
<p><img src="/images/post_interno/todos.png" style="width:75.0%" /></p>
<p>Cada ponto do gráfico é uma canção do álbum. Os álbuns escolhidos foram:</p>
<ul>
<li>U2, The Joshua Tree</li>
<li>Queen, Live At Wembley Stadium</li>
<li>Pink Floyd, The Later Years</li>
<li>Red Hot Chili Peppers, Californication</li>
</ul>
</div>
<div id="código-e-mais-análises" class="section level3">
<h3>Código e mais análises</h3>
<p>Agora vou compartilhar outras análises que fiz e o código utilizado.</p>
<div id="passo-1---instalarchamar-bibliotecas-e-autenticação" class="section level4">
<h4>Passo 1 - Instalar/Chamar bibliotecas e autenticação</h4>
<pre class="r"><code>library(tidyverse)
library(spotifyr)
library(genius)
library(tidytext)
library(gridExtra)
library(wordcloud2)
library(dplyr)
library(ggplot2)
library(highcharter)
library(RColorBrewer)
library(randomForest)</code></pre>
<pre class="r"><code># Você precisa criar as suas credenciais no Spotify e colocá-las aqui:
Sys.setenv(SPOTIFY_CLIENT_ID = &#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;)
Sys.setenv(SPOTIFY_CLIENT_SECRET = &#39;XXXXXXXXXXXXXXXXXXXXXXXXXX&#39;)
# Para criar o seu acesso a API de desenvolvedor do Spotify, siga os passos em:
# https://developer.spotify.com/dashboard/login</code></pre>
<p>Buscar o token de autenticação</p>
<pre class="r"><code>access_token &lt;- get_spotify_access_token()</code></pre>
</div>
<div id="buscar-e-limpar-os-dados" class="section level4">
<h4>Buscar e limpar os dados</h4>
<p>Essa função busca no Spotify as principais informações de todas as músicas da banda que você escolher.</p>
<p>No caso, escolhi o U2.</p>
<pre class="r"><code>banda &lt;- get_artist_audio_features(&#39;u2&#39;) ### Buscar os dados</code></pre>
<pre class="r"><code># Forças as algumas variáveis a serem da Classe de Fatores
banda$mode_name &lt;- as.factor(banda$mode_name)
banda$key_name &lt;- as.factor(banda$key_name)
banda$key_mode &lt;- as.factor(banda$key_mode)
banda$album_name &lt;- as.factor(banda$album_name)
banda$album_name &lt;- as.factor(banda$album_name)

# tirar musicas repetidas
banda&lt;-banda[!duplicated(banda$track_name),]

# tirar albuns repetidos
banda&lt;-dedupe_album_names(banda, album_name_col = &quot;album_name&quot;,
                   album_release_year_col = &quot;album_release_year&quot;)</code></pre>
</div>
<div id="principais-músicas-e-álbuns" class="section level4">
<h4>Principais músicas e álbuns</h4>
<p>Agora, busquei no Spotify quais são as músicas de mais sucesso da banda. Eles retornam as 10 músicas mais ouvidas.</p>
<pre class="r"><code># buscar músicas de maior sucesso no mercado Americano
top_tracks&lt;-get_artist_top_tracks(id=banda$artist_id[1], market = &quot;US&quot;,
                                  authorization = get_spotify_access_token(),
                                  include_meta_info = TRUE)$tracks

# criar uma coluna na tabela informando se a música é top track ou não.
banda &lt;- banda %&gt;%
  mutate(topsongs = ifelse(tolower(substr(banda$track_name, start = 1, stop = 11)) %in%
                             tolower(substr(top_tracks$name, start = 1, stop = 11)), 1,0))
banda$topsongs &lt;- as.factor(banda$topsongs)</code></pre>
<p>Definindo quais são os principais albuns da banda.</p>
<pre class="r"><code># Defini que os os principais albuns são aqueles que tem alguma música de sucesso
main_albuns&lt;-banda %&gt;% filter(topsongs==1) %&gt;%
  select(album_name)
banda_albums &lt;- banda[banda$album_name %in% main_albuns$album_name,]
banda &lt;- banda %&gt;%
  mutate(topalbum = ifelse(album_name %in% main_albuns$album_name , 1,0))
banda$topalbum &lt;- as.factor(banda$topalbum)</code></pre>
</div>
</div>
<div id="visualização-de-dados" class="section level3">
<h3>Visualização de dados</h3>
<p>Vamos começar a nossa visualização de dados analisando o sentimento das letras cantadas.</p>
<p>Busquei as 20 palavras mais cantadas no album e separamos as palavras em positivas e negativas.</p>
<p>Mas você concorda que palavras negativas podem ter intensidades muito diferentes?</p>
<p>Por exemplo, a palavra cortar é entendida como uma palavra negativa. Porém, sua intensidade é muito menor do que a de outras palavras negativas como veneno ou fogo.</p>
<p>Então, além de separar as palavras em positivas e negativas, vamos dar um score para cada sentimento.</p>
<pre class="r"><code>main_albuns$album_name&lt;-as.character(main_albuns$album_name)
indicador&lt;-names(which.max(table(main_albuns$album_name))[1])
banda_1 &lt;- banda %&gt;%
  filter(album_name == indicador)
banda_1 &lt;- banda_1[order(banda_1$tempo),] #sort
banda_1$track_name &lt;- factor(banda_1$track_name, levels = unique(banda_1$track_name))

#Creating a variable called D1 which contains all of the lyrics from Drake&#39;s album &quot;Thank Me Later&quot;
D1 &lt;- genius_album(artist = banda$artist_name[1], album = banda_1$album_name[1])

#Using the piping operator to create a count of the most popular words in the album 
D1 %&gt;% 
  unnest_tokens(word, lyric) %&gt;% 
  anti_join(stop_words) %&gt;% 
  count(word, sort = TRUE) -&gt; D1Count

#Using more piping operators to create afinn sentiment as well as create a subset of the data that includes the top 20 most popular words 
D1Count %&gt;% 
  inner_join(get_sentiments(&quot;afinn&quot;)) -&gt;  D1Sentiment

D1Sentiment %&gt;% head(20) -&gt; D1Sentiment2

#Creating a column called color that uses an if else statment to color the sentiment score by red if it is below 0 and green if it is above
D1Sentiment2$color &lt;- ifelse(D1Sentiment2$value &lt; 0, &quot;red&quot;, &quot;green&quot;)

#Creating a bar graph that shows each sentiment. The &quot;color=color&quot; in the ggplot() and scale_color_identity() are what allow the graph to color by red and green based off of the ifelse statement.
sentimento1 &lt;- ggplot(D1Sentiment2, aes(reorder(word, -n), value, color=color)) + geom_col(fill=&quot;white&quot;) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title=paste0(banda$artist_name[1],&quot; - &quot;,banda_1$album_name[1]), x=&quot;20 palavras mais cantadas&quot;, y=&quot;Score do sentimento&quot;) +
  theme(plot.title = element_text(size=15,hjust = 0.5)) +
  scale_color_identity()

sentimento1</code></pre>
<p><img src="public/blog/musica-e-possivel-aplicar-ciencia-de-dados_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>As nuvens de palavras ou wordclouds são uma ótima ferramenta para visualizar quais palavras são mais frequentes.</p>
<pre class="r"><code>wordcloud2(data = D1Count)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"word":["love","gotta","sunday","hoo","woo","sky","walk","day",null,"tonight","yeah","bloody","elevation","soul","feel","heart","mad","song","fly","hey","blue","home","ma","mama","leave","secret","sing","world","burning","fade","lost","money","rain","true","baby","beautiful","bullet","grace","night","coming","eyes","hard","lift","moment","released","star","stuck","summer","time","awake","blues","desire","falling","hallelujah","light","mark","slow","slowly","spirit","stand","break","chapman","girls","goal","gonna","live","sexy","tears","touch","wait","wide","wind","beauty","elevate","free","mind","ooh","peace","running","stateless","stay","steal","weight","aches","ah","beating","bit","breaks","check","cold","colors","control","crawl","deep","excavation","freedom","girl","guitar","hand","hundred","hurt","isolation","jesus","left","lot","lyrics","mmm","mole","raining","rock","safe","shine","sleeping","stop","taste","wall","war","wipe","afraid","alright","bee","beg","bird","black","breast","bring","cha","crack","cry","darkness","daylight","digging","feels","flower","hate","hear","hips","john","knees","lights","lips","living","mine","mo","motion","nails","pain","pass","red","sea","sheer","shoot","stars","stony","strong","sun","sweetness","takes","teach","tomorrow","twist","20","almighty","ambition","america","america's","angel","backstreets","bad","baggage","battle","begun","believed","bigger","bitter","blind","blood","blow","breath","breeze","bright","broken","bruised","build","bumper","buy","cage","care","carries","change","child","cigar","cloud","coloured","colours","controls","corner","deny","die","dollar","dream","easy","eclipse","explain","fall","falter","fashion","fever","fire","flown","fool","friend","givе","glass","goodbye","goodness","gun","head","heal","heard","hearts","hesitate","hole","hopeless","hot","idea","inside","johnny","karma","late","levitate","life","lit","luck","makes","massachusetts","measure","needle","ohh","orange","orbit","packing","pest","pull","push","reason","revelation","rights","roll","runs","salvation","sell","sensation","separation","set","shot","singing","slapping","smile","sour","steel","sticker","street","streets","strings","strung","suitcase","taking","talk","thorn","top","town","travels","tree","trigger","voice","waiting","walks","wanna","weightless","won","worry","worth","wound","еducate","38","air","anymore","arms","arrow","artist","asleep","astray","atlantico","autograph","avenue","awkward","baby's","baiting","band","bar","basement","bass","battle's","beatle","bed","bedouin","bell","belong","belt","bills","bites","blame","bloom","blowing","blown","boat","bodies","body","bodybags","bone","born","bottles","boy","breaking","brothers","brought","bush","business","butter","call","calling","candle","cannibal","canyons","carry","cars","causе","chalk","champagne","chances","changed","chasing","chick","children","children's","china","city","claim","clearing","close","cocoa","collide","company","condition","conscience","cost","count","counter","cover","covers","crash","crawling","crazy","create","crosses","darling","dead","deal","deceased","decent","delight","demon","destination","difference","discover","dislocate","diving","dollars","door","doors","dreaming","dreams","dress","drink","driving","dropping","drove","dug","dying","earned","ears","eat","eclipsed","educate","election","elliptical","em","enchanted","enemy","escaping","eternally","exploding","eye","falls","fate","fateless","fear","feet","fiction","fields","fill","filled","fingers","fingertips","firefly","fires","fireworks","flag","flame","flames","flat","fleets","flood","flush","flute","forever","forsake","found","fragrant","friction","friday","front","generous","giving","glow","glue","god","gravity","green","grief","grip","ground","growing","grown","guy","half","hall","hands","happen","happened","hardness","hateless","heavy","heed","hip","history","holding","holy","honey","hop","hope","howling","hum","i'vе","ideas","illogical","imagination","immune","inspiration","jacob","jamaica","job","jumping","kill","kisses","kite","knowing","lead","leaf","lend","liar","lie","line","lines","listen","listened","lives","locked","locust","lose","loud","lover","man's","map","marrow","mart","maximum","maze","media","meet","melody","millimeters","millions","moon","moreilla","mortal","motherload","mothers","mouth","moving","mud","newborn","news","nights","notes","obvious","oil","outta","overcome","pacing","parapet","paying","pearl","pearls","peeling","perfect","person","plant","poet","police","political","pram","prayer","preacher","pretty","prize","protеction","protection","proud","pulse","pushed","race","raise","ramp","rattle","reach","real","reality","rearrange","removes","rent","rerelease","return","ring","ringing","road","rocket","roof","rose","royal","rum","run","rush","safety","salt","sand","scared","scatter","scene","scent","scheme","seed","sense","sets","seventeen","seventy","shadow","shaking","shame","share","ship","shoe","shook","shoots","shore","shotgun","shut","silken","sister","sisters","sit","skies","skin","skips","sleep","sleight","slipped","soulmate","souls","space","spanish","speak","spiritual","spoon","sports","spotlight","stain","start","stealing","stinging","stings","stone","storm","straight","strewn","success","sugar","sunshine","superficial","surely","surrender","sweet","taping","target","tear","telling","temptation","tequila","thе","thepromise","thief","thinner","thousand","throw","tied","til","times","tiny","tongue","torn","tough","traffic","trail","traveling","trenches","tropical","tuna","tv","twirls","ugly","uh","unconscious","uncool","underneath","universe","valley","victory","vietnam","waking","wal","warm","waste","water","weak","wear","weather","whoa","win","wreck","wrestled","ya","yeahyay","yoko"],"freq":[66,45,41,33,33,30,28,26,26,25,22,20,19,19,17,16,14,14,13,13,12,12,12,12,11,11,11,11,10,10,10,10,10,10,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":2.72727272727273,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
<p>Por fim, coloquei em um gráfico os valores de <strong>energia</strong> e <strong>positividade</strong> de cada música do principal album da banda.</p>
<pre class="r"><code>artist_quadrant_chart(banda_1) %&gt;% 
  hc_add_event_point(event = &#39;mouseOver&#39;)</code></pre>
<p><img src="/images/post_interno/joshuatree.png" style="width:75.0%" /></p>
</div>
